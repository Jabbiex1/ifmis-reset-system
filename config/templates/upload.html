{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Submit Request ‚Äî IFMIS Help Desk</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --navy:#0f1f3d;--navy-mid:#1a3260;--navy-light:#2a4a8a;--navy-pale:#eef2fa;
  --accent:#3b82f6;--accent-dark:#2563eb;
  --white:#ffffff;--gray-50:#f8fafc;--gray-100:#f1f5f9;--gray-200:#e2e8f0;
  --gray-400:#94a3b8;--gray-600:#475569;--gray-800:#1e293b;
  --success:#16a34a;--radius:8px;--shadow:0 1px 3px rgba(0,0,0,.08),0 4px 16px rgba(0,0,0,.06);
}
body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--gray-50);color:var(--gray-800);min-height:100vh;display:flex;flex-direction:column;font-size:15px;line-height:1.6}

.header{background:var(--navy);padding:0 16px}
.header-inner{
  max-width:1100px;
  margin:0 auto;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:12px 0;
}
.header-left{display:flex;align-items:center;gap:12px}
.crest{
  width:40px;height:40px;border-radius:50%;
  background:rgba(255,255,255,.12);
  border:1px solid rgba(255,255,255,.2);
  display:flex;align-items:center;justify-content:center;
  font-size:1.2rem;flex-shrink:0
}
.header-text .org{
  font-size:.65rem;
  font-weight:600;
  letter-spacing:.08em;
  text-transform:uppercase;
  color:rgba(255,255,255,.5)
}
.header-text .title{
  font-size:.95rem;
  font-weight:700;
  color:#fff
}
.menu-toggle{
  display:none;
  background:none;
  border:none;
  color:#fff;
  font-size:1.5rem;
  cursor:pointer
}
.header-nav{display:flex;gap:6px}
.header-nav a{
  color:rgba(255,255,255,.6);
  text-decoration:none;
  font-size:.8rem;
  font-weight:500;
  padding:6px 12px;
  border-radius:6px;
  transition:.15s
}
.header-nav a:hover{background:rgba(255,255,255,.08);color:#fff}
.header-nav a.active{background:rgba(59,130,246,.25);color:#93c5fd}

/* MOBILE */
@media(max-width:640px){
  .menu-toggle{display:block}
  .header-nav{
    position:absolute;
    top:60px;
    left:0;
    right:0;
    background:var(--navy);
    flex-direction:column;
    padding:12px;
    display:none
  }
  .header-nav.show{display:flex}
  .header-text .org{display:none}
}
/* MAIN */
main{flex:1;max-width:1100px;margin:0 auto;width:100%;padding:32px 24px 60px}

/* PAGE HERO */
.page-hero{margin-bottom:28px}
.page-hero h1{font-size:1.5rem;font-weight:700;color:var(--navy);line-height:1.3}
.page-hero p{font-size:.9rem;color:var(--gray-600);margin-top:6px}

/* STEPS BAR */
.steps{display:flex;align-items:center;gap:0;margin-bottom:28px;background:var(--white);border:1px solid var(--gray-200);border-radius:var(--radius);padding:14px 20px;box-shadow:var(--shadow)}
.step{display:flex;align-items:center;gap:10px;flex:1}
.step:not(:last-child)::after{content:'‚Ä∫';color:var(--gray-400);font-size:1.1rem;margin:0 8px}
.step-num{width:26px;height:26px;border-radius:50%;background:var(--gray-100);border:2px solid var(--gray-200);color:var(--gray-400);font-size:.75rem;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:.2s}
.step.active .step-num{background:var(--accent);border-color:var(--accent);color:#fff}
.step-text{font-size:.78rem;font-weight:600;color:var(--gray-400)}
.step.active .step-text{color:var(--navy)}

/* PDF BANNER */
.pdf-banner{background:var(--navy);border-radius:var(--radius);padding:20px 24px;display:flex;align-items:center;justify-content:space-between;gap:20px;margin-bottom:24px;flex-wrap:wrap}
.pdf-banner-left{display:flex;align-items:center;gap:16px}
.pdf-icon{width:48px;height:48px;background:rgba(59,130,246,.2);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.4rem;flex-shrink:0}
.pdf-info .label{font-size:.7rem;font-weight:600;letter-spacing:.08em;text-transform:uppercase;color:rgba(255,255,255,.5);margin-bottom:3px}
.pdf-info .name{font-size:.95rem;font-weight:600;color:#fff}
.pdf-info .desc{font-size:.78rem;color:rgba(255,255,255,.5);margin-top:2px}
.btn-download{display:inline-flex;align-items:center;gap:8px;padding:10px 20px;background:var(--accent);color:#fff;border-radius:6px;font-family:'Plus Jakarta Sans',sans-serif;font-size:.82rem;font-weight:600;text-decoration:none;transition:.15s;white-space:nowrap;flex-shrink:0}
.btn-download:hover{background:var(--accent-dark)}

/* LAYOUT */
.layout{display:grid;grid-template-columns:1fr 300px;gap:24px;align-items:start}

/* CARD */
.card{background:var(--white);border:1px solid var(--gray-200);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
.card-header{padding:16px 24px;border-bottom:1px solid var(--gray-100);display:flex;align-items:center;gap:10px}
.card-header h2{font-size:.95rem;font-weight:700;color:var(--navy)}
.card-header p{font-size:.78rem;color:var(--gray-400);margin-top:2px}
.card-body{padding:24px}

/* FORM */
.field{margin-bottom:18px}
.field label{display:block;font-size:.8rem;font-weight:600;color:var(--gray-600);margin-bottom:6px}
.field label .req{color:var(--accent);margin-left:2px}
.field input,.field select,.field textarea{width:100%;padding:10px 14px;border:1.5px solid var(--gray-200);border-radius:6px;font-family:'Plus Jakarta Sans',sans-serif;font-size:.88rem;color:var(--gray-800);background:var(--gray-50);outline:none;transition:.15s}
.field input:focus,.field select:focus,.field textarea:focus{border-color:var(--accent);background:#fff;box-shadow:0 0 0 3px rgba(59,130,246,.1)}
.field input[type=file]{background:#fff;cursor:pointer;padding:8px 12px}
.field .hint{font-size:.74rem;color:var(--gray-400);margin-top:5px}
.field .err{font-size:.74rem;color:var(--error,#dc2626);margin-top:5px}
.field-row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.section-divider{font-size:.72rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--gray-400);padding:16px 0 12px;border-bottom:1px solid var(--gray-100);margin-bottom:18px}
.form-footer{display:flex;align-items:center;justify-content:space-between;padding-top:16px;border-top:1px solid var(--gray-100);gap:12px;flex-wrap:wrap}
.form-note{font-size:.74rem;color:var(--gray-400);max-width:260px}
.btn-submit{display:inline-flex;align-items:center;gap:8px;padding:11px 28px;background:var(--navy);color:#fff;border:none;border-radius:6px;font-family:'Plus Jakarta Sans',sans-serif;font-size:.88rem;font-weight:600;cursor:pointer;transition:.15s}
.btn-submit:hover{background:var(--navy-mid)}

/* SIDEBAR */
.sidebar{display:flex;flex-direction:column;gap:16px}
.info-block{background:var(--white);border:1px solid var(--gray-200);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow)}
.info-block-title{font-size:.72rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--gray-600);padding:12px 16px;border-bottom:1px solid var(--gray-100);background:var(--gray-50)}
.info-block-body{padding:16px}
.steps-list{list-style:none;display:flex;flex-direction:column;gap:12px}
.steps-list li{display:flex;gap:10px;font-size:.82rem;color:var(--gray-600);line-height:1.5}
.steps-list .n{width:20px;height:20px;border-radius:50%;background:var(--navy);color:#fff;font-size:.68rem;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px}
.notice{background:var(--navy-pale);border:1px solid rgba(59,130,246,.2);border-left:3px solid var(--accent);border-radius:6px;padding:12px 14px;font-size:.78rem;color:var(--navy-mid);line-height:1.6}
.notice strong{display:block;margin-bottom:3px;font-weight:700}
.contact-lines{font-size:.82rem;color:var(--gray-600);line-height:2}
.contact-lines strong{color:var(--navy);font-weight:600;display:block;margin-bottom:4px}

/* SUCCESS */
.success-wrap{text-align:center;padding:40px 24px}
.success-icon{width:64px;height:64px;background:#dcfce7;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.8rem;margin:0 auto 18px}
.success-wrap h2{font-size:1.3rem;font-weight:700;color:var(--navy);margin-bottom:8px}
.success-wrap p{font-size:.88rem;color:var(--gray-600);margin-bottom:24px}
.ref-box{display:inline-block;background:var(--navy);color:#fff;font-family:'Courier New',monospace;font-size:1.6rem;font-weight:700;letter-spacing:5px;padding:16px 32px;border-radius:8px;margin-bottom:10px}
.ref-note{font-size:.78rem;color:var(--gray-400);margin-bottom:28px}
.success-actions{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.btn{display:inline-flex;align-items:center;gap:7px;padding:10px 20px;border-radius:6px;font-family:'Plus Jakarta Sans',sans-serif;font-size:.84rem;font-weight:600;text-decoration:none;cursor:pointer;border:none;transition:.15s}
.btn-primary{background:var(--accent);color:#fff}.btn-primary:hover{background:var(--accent-dark)}
.btn-outline{background:#fff;color:var(--navy);border:1.5px solid var(--gray-200)}.btn-outline:hover{background:var(--gray-50)}
.btn-ghost{background:var(--gray-100);color:var(--gray-600);border:none}.btn-ghost:hover{background:var(--gray-200)}

/* FLASH */
.flash{background:#fff;border:1px solid var(--gray-200);border-left:3px solid var(--accent);border-radius:6px;padding:12px 16px;font-size:.84rem;color:var(--navy);margin-bottom:20px}

/* FOOTER */
footer{background:var(--navy);color:rgba(255,255,255,.4);font-size:.74rem;text-align:center;padding:16px 24px}
footer a{color:rgba(255,255,255,.5);text-decoration:none}
footer a:hover{color:#fff}

/* RESPONSIVE */
@media(max-width:768px){
  .layout{grid-template-columns:1fr}
  .field-row{grid-template-columns:1fr}
  .steps .step-text{display:none}
  .pdf-banner{flex-direction:column;align-items:flex-start}
  .btn-download{width:100%;justify-content:center}
  .form-footer{flex-direction:column;align-items:stretch}
  .btn-submit{width:100%;justify-content:center}
}
@media(max-width:480px){
  main{padding:20px 16px 48px}
  .header-nav{display:none}
  .success-actions{flex-direction:column}
  .btn{width:100%;justify-content:center}
}
</style>
</head>
<body>

<div class="header">
  <div class="header-inner">
    <div class="header-left">
      <div class="crest">üá∏üá±</div>
      <div class="header-text">
        <div class="org">Ministry of Finance ¬∑ Sierra Leone</div>
        <div class="title">IFMIS Help Desk Portal</div>
      </div>
    </div>

    <button class="menu-toggle" onclick="toggleMenu()">‚ò∞</button>

    <nav class="header-nav" id="navMenu">
      <a href="/" class="active">Submit Request</a>
      <a href="/track/">Track Request</a>
      <a href="/staff/login/">Staff Login</a>
    </nav>
  </div>
</div>

<main>

{% if reference_code %}
<!-- SUCCESS STATE -->
<div class="card">
  <div class="success-wrap">
    <div class="success-icon">‚úÖ</div>
    <h2>Request Submitted Successfully</h2>
    <p>Your IFMIS password reset request has been received.<br>Save your reference code ‚Äî you'll need it to track your request.</p>
    <div class="ref-box">{{ reference_code }}</div>
    <div class="ref-note">üîí Keep this code safe. Do not share it with anyone.</div>
    <div class="success-actions">
      <a href="/track/" class="btn btn-primary">Track My Request</a>
      <a href="/" class="btn btn-outline">Submit Another</a>
      <button onclick="window.print()" class="btn btn-ghost">Print</button>
    </div>
  </div>
</div>

{% else %}
<!-- FORM STATE -->

<div class="page-hero">
  <h1>IFMIS Password Reset Request</h1>
  <p>Complete the form below to submit a password reset request to the IFMIS Help Desk.</p>
</div>

<div class="steps">
  <div class="step active"><div class="step-num">1</div><div class="step-text">Download Form</div></div>
  <div class="step active"><div class="step-num">2</div><div class="step-text">Fill &amp; Upload</div></div>
  <div class="step"><div class="step-num">3</div><div class="step-text">Under Review</div></div>
  <div class="step"><div class="step-num">4</div><div class="step-text">Processed</div></div>
</div>

<!-- PDF Download -->
<div class="pdf-banner">
  <div class="pdf-banner-left">
    <div class="pdf-icon">üìÑ</div>
    <div class="pdf-info">
      <div class="label">Step 1 ‚Äî Official Form</div>
      <div class="name">IFMIS Password Reset Request Form</div>
      <div class="desc">Download, fill it in, then upload it below together with your details</div>
    </div>
  </div>
  <a href="{% static 'IFMIS_FORM.pdf' %}" download="IFMIS_Password_Reset_Form.pdf" class="btn-download">
    ‚¨á Download Form (PDF)
  </a>
</div>

{% if messages %}
  {% for message in messages %}
  <div class="flash">{{ message }}</div>
  {% endfor %}
{% endif %}

<div class="layout">

  <!-- Form -->
  <div class="card">
    <div class="card-header">
      <div>
        <h2>Step 2 ‚Äî Submit Your Request</h2>
        <p>Fill in your details and upload the completed PDF form</p>
      </div>
    </div>
    <div class="card-body">
      <form method="post" enctype="multipart/form-data" novalidate>
        {% csrf_token %}

        <div class="section-divider">Personal Information</div>

        <div class="field">
          <label for="id_full_name">Full Name <span class="req">*</span></label>
          {{ form.full_name }}
          {% if form.full_name.errors %}<div class="err">{{ form.full_name.errors|join:", " }}</div>{% endif %}
        </div>

        <div class="field">
          <label for="id_department">Department / MDA <span class="req">*</span></label>
          {{ form.department }}
          {% if form.department.errors %}<div class="err">{{ form.department.errors|join:", " }}</div>{% endif %}
        </div>

        <div class="field">
          <label for="id_email">Official Email Address <span class="req">*</span></label>
          {{ form.email }}
          <div class="hint">Use your official government email (e.g. name@mof.gov.sl)</div>
          {% if form.email.errors %}<div class="err">{{ form.email.errors|join:", " }}</div>{% endif %}
        </div>

        <div class="section-divider">Upload Completed Form</div>

        <div class="field">
          <label for="id_uploaded_file">Completed PDF Form <span class="req">*</span></label>
          {{ form.uploaded_file }}
          <div class="hint">Upload the filled-in IFMIS Password Reset Form. Accepted: PDF, JPG, PNG (max 5MB)</div>
          {% if form.uploaded_file.errors %}<div class="err">{{ form.uploaded_file.errors|join:", " }}</div>{% endif %}
        </div>

        <div class="form-footer">
          <div class="form-note">By submitting you confirm the information provided is accurate.</div>
          <button type="submit" class="btn-submit">Submit Request ‚Üí</button>
        </div>

      </form>
    </div>
  </div>

  <!-- Sidebar -->
  <div class="sidebar">

    <div class="info-block">
      <div class="info-block-title">How It Works</div>
      <div class="info-block-body">
        <ul class="steps-list">
          <li><div class="n">1</div>Download and fill the official PDF form.</li>
          <li><div class="n">2</div>Submit this form with your details and the filled PDF.</li>
          <li><div class="n">3</div>You receive a unique reference code immediately.</li>
          <li><div class="n">4</div>Use the code at <a href="/track/" style="color:var(--accent)">Track Request</a> to check status and message the Help Desk.</li>
          <li><div class="n">5</div>Once processed, your new password is sent to your email.</li>
        </ul>
      </div>
    </div>

    <div class="notice">
      <strong>‚ö† Save Your Reference Code</strong>
      After submitting, your reference code will be shown once. Save it immediately ‚Äî it cannot be recovered if lost.
    </div>

    <div class="info-block">
      <div class="info-block-title">Help Desk Contact</div>
      <div class="info-block-body">
        <div class="contact-lines">
          <strong>IFMIS Support Unit</strong>
          üìß ifmis.support@mof.gov.sl<br>
          üìû +232 31 399 020<br>
          üïê Mon‚ÄìFri, 8:00am‚Äì5:00pm

          
        </div>
      </div>
    </div>

  </div>
</div>
{% endif %}

</main>

<footer>
  ¬© 2026 Ministry of Finance, Republic of Sierra Leone &nbsp;¬∑&nbsp;
  <a href="/track/">Track Request</a> &nbsp;¬∑&nbsp;
  <a href="/staff/login/">Staff Login</a>
</footer>
<script>
function toggleMenu(){
  document.getElementById("navMenu").classList.toggle("show");
}
</script>
</body>
</html>
